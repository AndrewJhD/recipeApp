<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Storage App</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 0;
        }
        .tabs {
            display: flex;
            border-bottom: 2px solid #ccc;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border: 1px solid #ccc;
            border-bottom: none;
        }
        .tab.active {
            background-color: #f0f0f0;
            font-weight: bold;
        }
        .content {
            display: none;
            padding: 20px;
            border: 1px solid #ccc;
        }
        .content.active {
            display: block;
        }
        .search-container {
            margin-bottom: 20px;
        }
        .advanced-search {
            display: none;
            margin-top: 10px;
        }
        .filter-options {
            display: none;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="tabs">
        <div class="tab active" onclick="showTab('viewRecipes')">My Recipes</div>
        <div class="tab" onclick="showTab('addRecipe')">Upload Recipe</div>
        <div class="tab" onclick="showTab('search')">Search</div>
    </div>
    
    <div id="viewRecipes" class="content active">
        <h2>My Recipes</h2>
        <label for="sort-recipes">Sort by:</label>
        <select id="sort-recipes" onchange="sortRecipes()">
            <option value="name">Name</option>
            <option value="difficulty">Difficulty</option>
        </select>
        <br>
        <div id="recipe-list"></div>
    </div>

    <div id="addRecipe" class="content">
        <h2>Upload Recipe</h2>
        <form id="recipe-form">
            <label>Recipe Name:</label> 
            <input type="text" id="recipe-name" required><br>
            <label>Difficulty:</label>
            <select id="recipe-difficulty" required>
                <option value="Easy">Easy</option>
                <option value="Medium">Medium</option>
                <option value="Hard">Hard</option>
            </select><br>
            <label>Time Required:</label>
            <input type="text" id="recipe-time" required><br>
            <label>Ingredients:</label>
            <div id="ingredients-list"></div> 
            <button type="button" onclick="addIngredient()">Add Ingredient</button><br>
            <label>Directions:</label>
            <div id="directions-list"></div>
            <button type="button" onclick="addDirection()">Add Step</button> <br>
            <label>Upload Image:</label>
            <input type="file" id="recipe-image" accept="image/*"> <br> <br>
            <button type="submit">Submit Recipe</button>
        </form>
    </div>
    
    <div id="search" class="content">
        <h2>Search Your Recipes</h2>
        <div class="search-container">
            <input type="text" id="search-bar" placeholder="Search by name...">
            <button onclick="performSearch()">Search</button> <br>
            <button onclick="toggleAdvancedSearch()">Advanced Search</button>
        </div>
        <div id="advancedSearch" class="advanced-search">
            <h2>Advanced Search</h2>
            <div class="input-group">
                <label>Other Filters:</label>
                <select id="filter-type" onchange="toggleFilterOptions()">
                    <option value="">Select a filter</option>
                    <option value="ingredients">Ingredients</option>
                    <option value="cook-time">Cooking Time</option>
                    <option value="difficulty">Difficulty</option>
                    <option value="meal-type">Meal Type</option>
                </select>
            </div>
            <div id="ingredients-options" class="filter-options">
                <label>Include Ingredients:</label>
                <select id="include-ingredients"></select>
                <label>Exclude Ingredients:</label>
                <select id="exclude-ingredients"></select>
            </div>
            <div id="cook-time-options" class="filter-options">
                <label>Cook Time:</label>
                <select id="cook-time"></select>
            </div>
            <div id="difficulty-options" class="filter-options">
                <label>Difficulty:</label>
                <select id="difficulty"></select>
            </div>
            <div id="meal-type-options" class="filter-options">
                <label>Meal Type:</label>
                <select id="meal-type"></select>
            </div>
            <button>Search</button>
        </div>
    </div>
    
    <script>
        const ingredients = ["Spinach", "Garlic", "Cream", "Tomato", "Basil", "Chicken", "Beef", "Carrot", "Potato"];
        const cookTime = ["30 mins and under", "30 min - 1 hour", "1+ hours"];
        const difficulty = ["Easy", "Medium", "Hard"];
        const mealType = ["Breakfast", "Lunch", "Dinner", "Snack"];
        
        function populateDropdown(dropdownId, dataArray) {
            const dropdown = document.getElementById(dropdownId);
            dropdown.innerHTML = '<option value="">Select</option>';
            dataArray.forEach(item => {
                let option = document.createElement("option");
                option.value = item;
                option.textContent = item;
                dropdown.appendChild(option);
            });
        }
        
        function toggleFilterOptions() {
            document.querySelectorAll(".filter-options").forEach(option => {
                option.style.display = "none";
            });
            const selectedFilter = document.getElementById("filter-type").value;
            if (selectedFilter) {
                document.getElementById(`${selectedFilter}-options`).style.display = "block";
            }
        }
        
        function showTab(tabId) {
            document.querySelectorAll('.content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }
        
        function toggleAdvancedSearch() {
            const advancedSearch = document.getElementById("advancedSearch");
            advancedSearch.style.display = advancedSearch.style.display === "none" || advancedSearch.style.display === "" ? "block" : "none";
        }
        
        function addIngredient() {
            const list = document.getElementById("ingredients-list");
            const ingredientDiv = document.createElement("div");
            ingredientDiv.innerHTML = `
                <input type="text" placeholder="Ingredient Name" class="ingredient-name">
                <input type="text" placeholder="Measurement (e.g., 1 cup)" class="ingredient-measurement">
                <input type="text" placeholder="Size (e.g., chopped, diced)" class="ingredient-size">
                <button type="button" onclick="this.parentElement.remove()">Remove</button>
            `;
            list.appendChild(ingredientDiv);
        }

        function addDirection() {
            const list = document.getElementById("directions-list");
            const stepNumber = list.children.length + 1;
            const directionDiv = document.createElement("div");
            directionDiv.innerHTML = `
                <span>Step ${stepNumber}:</span>
                <input type="text" class="direction-step">
                <button type="button" onclick="this.parentElement.remove()">Remove</button>
            `;
            list.appendChild(directionDiv);
        }
        
        let recipes = [];

        document.getElementById("recipe-form").addEventListener("submit", function(event) {
            event.preventDefault();

            const recipeName = document.getElementById("recipe-name").value;
            const recipeDifficulty = document.getElementById("recipe-difficulty").value;
            const recipeTime = document.getElementById("recipe-time").value;

            const ingredients = [];
            document.querySelectorAll("#ingredients-list div").forEach(div => {
                const name = div.querySelector(".ingredient-name").value;
                const measurement = div.querySelector(".ingredient-measurement").value;
                const size = div.querySelector(".ingredient-size").value;
                if (name && measurement) {
                    ingredients.push({ name, measurement, size });
                }
            });

            const directions = [];
            document.querySelectorAll(".direction-step").forEach(input => {
                if (input.value.trim()) {
                    directions.push(input.value.trim());
                }
            });


            const imageFile = document.getElementById("recipe-image").files[0];

            const recipeData = {
                name: recipeName,
                difficulty: recipeDifficulty,
                time: recipeTime,
                ingredients,
                directions,
                image: imageFile ? URL.createObjectURL(imageFile) : null,
                expanded: false
            };

            console.log(recipeData);
            recipes.push(recipeData);
            displayRecipes();
            
            document.getElementById("recipe-form").reset();
            document.getElementById("ingredients-list").innerHTML = "";
            document.getElementById("directions-list").innerHTML = "";
        });

        function displayRecipes() {
            const recipeContainer = document.getElementById("recipe-list");
            if (!recipeContainer) return;
            recipeContainer.innerHTML = "";
            
            recipes.forEach((recipe, index) => {
                const recipeDiv = document.createElement("div");
                recipeDiv.classList.add("recipe");
                
                let recipeContent = `
                    <h3>${recipe.name}</h3>
                    <p>Difficulty: ${recipe.difficulty}</p>
                    <p>Time: ${recipe.time}</p>
                    <button onclick="toggleFullRecipe(${index})">
                        ${recipe.expanded ? "Hide Full Recipe" : "View Full Recipe"}
                    </button>
                `;
                
                if (recipe.expanded) {
                    let ingredientsHtml = "<ul>" + recipe.ingredients.map(ing => `<li>${ing.name} - ${ing.measurement} (${ing.size})</li>`).join("") + "</ul>";
                    let directionsHtml = "<ol>" + recipe.directions.map(dir => `<li>${dir}</li>`).join("") + "</ol>";
                    
                    recipeContent += `
                        <p><strong>Ingredients:</strong></p>
                        ${ingredientsHtml}
                        <p><strong>Directions:</strong></p>
                        ${directionsHtml}
                        ${recipe.image ? `<img src="${recipe.image}" alt="Recipe Image" style="max-width:200px;">` : ""}
                        <button onclick="deleteRecipe(${index})">Delete</button>
                    `;
                }
                
                recipeDiv.innerHTML = recipeContent;
                recipeContainer.appendChild(recipeDiv);
            });
        }

        function toggleFullRecipe(index) {
            recipes[index].expanded = !recipes[index].expanded;
            displayRecipes();
        }

        function deleteRecipe(index) {
            recipes.splice(index, 1);
            displayRecipes();
        }

        
        function sortRecipes() {
            const sortBy = document.getElementById("sort-recipes").value;
            if (sortBy === "name") {
                recipes.sort((a, b) => a.name.localeCompare(b.name));
            } else if (sortBy === "difficulty") {
                const difficultyOrder = { "Easy": 1, "Medium": 2, "Hard": 3 };
                recipes.sort((a, b) => difficultyOrder[a.difficulty] - difficultyOrder[b.difficulty]);
            }
            displayRecipes();
        }
        
        window.onload = function() {
            populateDropdown("include-ingredients", ingredients);
            populateDropdown("exclude-ingredients", ingredients);
            populateDropdown("cook-time", cookTime);
            populateDropdown("difficulty", difficulty);
            populateDropdown("meal-type", mealType);
            displayRecipes();
        };
    </script>
    </script>
</body>
</html>